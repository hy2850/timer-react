{"version":3,"sources":["components/TimeSettingsModal.js","components/WritableClock.js","sound/beep.mp3","sound/bell.mp3","img/tomato.png","components/Timer.js","slices/notiSlice.js","components/GeneralSettingsModal.js","App.js","app/store.js","index.js"],"names":["TimeSettingsModal","props","useState","type","timerMin","setTimerMin","breakMin","setBreakMin","useEffect","document","addEventListener","keydownEvents","removeEventListener","evt","isOpen","code","saveSettings","preventDefault","timeObj","timerTime","Number","parseInt","breakTime","save","close","className","id","closeTimeoutMS","onRequestClose","onSubmit","step","min","max","value","onChange","target","WritableClock","minWriteFlag","setMinWriteFlag","secWriteFlag","setSecWriteFlag","setMin","sec","setSec","tmp","setTmp","startWriting","pause","applyChange","oldT","newT","isNaN","alert","console","log","changedTime","update","useLayoutEffect","Math","floor","time","toString","padStart","elem","getElementById","focus","onBlur","onDoubleClick","Modal","setAppElement","MINUTE","TITLE","Timer","initTime","useRef","settings","initBreak","alarmVol","volume","autoStart","anchorDate","current","curTime","setCurTime","didStart","setDidStart","onBreak","setBreak","modalOpen","setModalOpen","key","setKey","onNoti","useSelector","state","ctrlKey","reset","doPause","sendNotification","breakStart","title","body","notification","Notification","icon","IMG","window","applyTimeSettings","cachedTimeObj","JSON","parse","localStorage","getItem","Object","assign","shortTT","shortBT","longTT","longBT","setItem","stringify","useUpdateEffect","clockStr","moment","add","useInterval","audio","Audio","BEEP","BELL","playCnt","a","Promise","r","setTimeout","this","currentTime","play","beep","diff","round","updateFromClock","onClick","checked","notiSlice","createSlice","name","initialState","reducers","turnOn","turnOff","actions","GeneralSettingsModal","curSettings","vol","setVol","setAutoStart","dispatch","useDispatch","settingsObj","parseFloat","permission","requestPermission","then","App","toggleSecond","setToggleSecond","initTimeObj","genSettingsObj","generalCache","timeCache","confirm","clear","location","reload","num","persistConfig","storage","version","persistedReducer","persistReducer","notiReducer","store","configureStore","reducer","middleware","getDefaultMiddleware","serializableCheck","ignoredActions","FLUSH","REHYDRATE","PAUSE","PERSIST","PURGE","REGISTER","persistor","persistStore","ReactDOM","render","StrictMode","loading"],"mappings":"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","file":"static/js/main.f8e91f13.chunk.js","sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport '../styles/SettingsModal.css';\r\nimport Modal from 'react-modal';\r\n\r\nModal.setAppElement('#root');\r\n\r\nexport default function TimeSettingsModal(props) {\r\n    const MINUTE = 60;\r\n    const [timerMin, setTimerMin] = useState(props.type === \"SHORT\" ? 25 : 50);\r\n    const [breakMin, setBreakMin] = useState(props.type === \"SHORT\" ? 5 : 10);\r\n\r\n    // set keyboard keydown\r\n    useEffect(() => {\r\n        document.addEventListener('keydown', keydownEvents);\r\n        return ()=>document.removeEventListener('keydown', keydownEvents);\r\n    });\r\n    \r\n    const keydownEvents = (evt)=>{\r\n        if(props.isOpen && (evt.code === 'Space' || evt.code === 'Enter')) // only when the modal is opened\r\n            saveSettings();\r\n    };\r\n\r\n\r\n    function saveSettings(evt){\r\n        if(evt) evt.preventDefault();\r\n\r\n        const timeObj = {\r\n            timerTime: Number.parseInt(timerMin) * MINUTE,\r\n            breakTime: Number.parseInt(breakMin) * MINUTE\r\n        }\r\n        props.save(timeObj);\r\n        props.close();\r\n    }\r\n\r\n    return (\r\n        <Modal \r\n            className=\"modal\" \r\n            id=\"time\"\r\n            closeTimeoutMS={200}\r\n            isOpen={props.isOpen} \r\n            onRequestClose={props.close}>\r\n            <div className=\"modal\" id=\"time\" >\r\n                <div className=\"modal-body\">  \r\n                    <form onSubmit={saveSettings}>\r\n                        <div className=\"settings\">\r\n                            <div className=\"settings-container-time\">\r\n                                <label>\r\n                                    Timer &nbsp;\r\n                                    <input className=\"time\" type=\"number\" step=\"5\" min=\"0\" max=\"99\" \r\n                                            value={timerMin} \r\n                                            onChange={(evt)=>{setTimerMin(evt.target.value);}}/>\r\n                                </label>\r\n\r\n                                <label>\r\n                                    Break &nbsp;\r\n                                    <input className=\"time\" type=\"number\" step=\"1\" min=\"0\" max=\"99\" \r\n                                            value={breakMin} \r\n                                            onChange={(evt)=>{setBreakMin(evt.target.value);}}/>\r\n                                </label>\r\n                            </div>\r\n                        </div>\r\n                        <input className=\"settings-save\" type=\"submit\" value=\"Submit\" />\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        </Modal>\r\n    )\r\n}","import React, {useState, useEffect, useLayoutEffect} from 'react';\r\nimport '../styles/Timer.css';\r\n\r\nexport default function WritableClock(props) {\r\n    const [minWriteFlag, setMinWriteFlag] = useState(false);\r\n    const [secWriteFlag, setSecWriteFlag] = useState(false);\r\n    const [min, setMin] = useState(\"00\");\r\n    const [sec, setSec] = useState(\"00\");\r\n    const [tmp, setTmp] = useState(\"\");\r\n\r\n    const MIN = 0, SEC = 1, MINIUTE = 60;\r\n\r\n    // Init time with props.time\r\n    useLayoutEffect(()=>{\r\n        //console.log(`WritableClock is rendering : ${props.time}`);\r\n        let min = Math.floor(props.time/MINIUTE); min = min.toString().padStart(2, '0');\r\n        let sec = props.time%MINIUTE; sec = sec.toString().padStart(2, '0');\r\n        setMin(min); setSec(sec);\r\n    }, []);\r\n\r\n\r\n    // =============================================================================\r\n    function startWriting(target){\r\n        setTmp(target === MIN ? min : sec); \r\n        target === MIN ? setMinWriteFlag(true) : setSecWriteFlag(true);\r\n        props.pause();\r\n    }\r\n\r\n    // Focus when startWriting\r\n    useEffect(()=>{\r\n        let elem = document.getElementById(\"minWrite\")\r\n        if(elem) elem.focus();\r\n    }, [minWriteFlag]);\r\n    useEffect(()=>{\r\n        let elem = document.getElementById(\"secWrite\")\r\n        if(elem) elem.focus();\r\n    }, [secWriteFlag]);\r\n\r\n\r\n    // =============================================================================\r\n    // Update valid time change\r\n    function applyChange(target){\r\n        const type = (target===MIN ? \"Minute\" : \"Second\");\r\n        let oldT = parseInt(target===MIN ? min : sec);\r\n        let newT = parseInt(tmp);\r\n\r\n        // Validation\r\n        if(isNaN(newT)){\r\n            alert(`${type} must be a number between 0 to ${target===MIN ? 99 : 59}`);\r\n        }\r\n        if((0 <= newT && newT < (target === MIN ? 100 : 60)) && oldT !== newT){\r\n            console.log(`Changing ${type} from ${oldT} to ${newT}`); // DEBUG            \r\n            const changedTime = target === MIN ? newT*MINIUTE + parseInt(sec) : parseInt(min)*MINIUTE + newT;            \r\n            props.update(changedTime);\r\n        } \r\n\r\n        target === MIN ? setMinWriteFlag(false) : setSecWriteFlag(false);\r\n    }\r\n\r\n    \r\n    return (\r\n        <div id=\"timer\">\r\n            {\r\n                minWriteFlag\r\n                ? <input className=\"write\" id=\"minWrite\" type=\"text\" value={tmp} onChange={(evt)=>{setTmp(evt.target.value)}} onBlur={()=>{applyChange(MIN)}}/>\r\n                : <span className=\"show\" onDoubleClick = {()=>{startWriting(MIN)}}>{min}</span>\r\n            } \r\n            :\r\n            {\r\n                secWriteFlag\r\n                ? <input className=\"write\" id=\"secWrite\" type=\"text\" value={tmp} onChange={(evt)=>{setTmp(evt.target.value)}} onBlur={()=>{applyChange(SEC)}}/>\r\n                : <span className=\"show\" onDoubleClick = {()=>{startWriting(SEC)}}>{sec}</span>\r\n            } \r\n        </div>\r\n    )\r\n}\r\n","export default __webpack_public_path__ + \"static/media/beep.3078eb82.mp3\";","export default __webpack_public_path__ + \"static/media/bell.b1616f76.mp3\";","export default \"data:image/png;base64,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\"","import React, {useState, useEffect, useRef, useLayoutEffect} from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport {useInterval, useUpdateEffect} from 'react-use';\r\nimport moment from 'moment';\r\nimport '../styles/Timer.css';\r\n\r\nimport TimeSettingsModal from './TimeSettingsModal.js';\r\nimport WritableClock from './WritableClock';\r\n\r\nimport BEEP from '../sound/beep.mp3'\r\nimport BELL from '../sound/bell.mp3'\r\n\r\nimport IMG from '../img/tomato.png'\r\n\r\nconst MINUTE = 60;\r\nconst TITLE = \"Pomodoro Timer+\";\r\n\r\nfunction Timer(props) {\r\n    // Options - preserve with useRef \r\n    let initTime = useRef(props.settings.timerTime);\r\n    let initBreak = useRef(props.settings.breakTime);\r\n    let alarmVol = useRef(props.settings.volume);\r\n    let autoStart = useRef(props.settings.autoStart);\r\n\r\n    // States for timer\r\n    let anchorDate = useRef(null);\r\n    const [curTime, setCurTime] = useState(initTime.current);\r\n    const [didStart, setDidStart] = useState(false);\r\n    const [onBreak, setBreak] = useState(false);\r\n\r\n    // Etc\r\n    const [modalOpen, setModalOpen] = useState(false);\r\n    const [key, setKey] = useState(0); // to re-render child component writableClock.js\r\n\r\n    // Redux\r\n    const onNoti = useSelector(state => state.onNoti);\r\n\r\n\r\n    //======================================================\r\n    // init - set keyboard keydown\r\n    useLayoutEffect(()=>{\r\n        document.addEventListener('keydown', keydownEvents);\r\n        return ()=>document.removeEventListener('keydown', keydownEvents);\r\n    });\r\n\r\n    const keydownEvents = (evt)=>{\r\n        if(evt.code === 'Space')\r\n            setDidStart(didStart => !didStart);\r\n        else if (evt.code === 'KeyR'){\r\n            if(evt.ctrlKey){\r\n                evt.preventDefault(); // remove 'Ctrl+R' reload page\r\n                setBreak(false);\r\n            }\r\n            else\r\n                reset();\r\n        }\r\n    };\r\n\r\n\r\n    // =============================================================================\r\n    // Update clock\r\n    useUpdateEffect(() => {\r\n        setKey(key => key + 1); // re-render writableClock\r\n        \r\n        // Update browser tab title with short clock\r\n        if(didStart){\r\n            let min = Math.floor(curTime/MINUTE); min = min.toString();\r\n            let sec = curTime%MINUTE; sec = sec.toString();\r\n            const clockStr = (min.padStart(2, '0') + \":\" + sec.padStart(2, '0'));\r\n            document.title = \"(\" + clockStr + \") \" + TITLE;\r\n        }\r\n    }, [curTime]);  \r\n\r\n\r\n    // countDown\r\n    useEffect(() => {\r\n        if(didStart)\r\n            anchorDate.current = moment().add(curTime, 's');\r\n        else\r\n            document.title = TITLE;\r\n    }, [didStart]);\r\n\r\n    useInterval(() => {\r\n        if(curTime <= 0) {\r\n            beep();\r\n            setBreak(onBreak => !onBreak); // toggle break status\r\n            //reset();\r\n            // restart taken care of by useEffect[onBreak]\r\n            return;\r\n        }\r\n\r\n        let diff = anchorDate.current.diff(moment()); // returns milliseconds\r\n        setCurTime(Math.round(diff/1000));\r\n    }, didStart ? 1000 : null);\r\n\r\n    \r\n    // onBreak - Break start or timer restart\r\n    useUpdateEffect(() => {\r\n        reset();\r\n        \r\n        if(curTime > 0) return; // user input break - time still left on the timer\r\n\r\n        // Break start\r\n        if(onBreak){\r\n            anchorDate.current = moment().add(initBreak.current, 's');\r\n            console.log(\"Break start : \", moment(), anchorDate.current)\r\n            setDidStart(true); // start break\r\n            sendNotification(true);\r\n        }\r\n        // Break over\r\n        else if (autoStart.current) {\r\n            anchorDate.current = moment().add(initTime.current, 's');\r\n            setDidStart(true); // option : autostart (Inf Loop? Stack?)\r\n            sendNotification(false);\r\n        }\r\n    }, [onBreak]);\r\n\r\n\r\n    // =============================================================================\r\n    // Reset/pause timer\r\n    function reset(doPause = false){\r\n        //console.log(doPause ? \"Pausing\" : \"Resetting\");\r\n        setDidStart(false);\r\n    \r\n        // resetting, not pause\r\n        if(!doPause) {\r\n            setCurTime(onBreak ? initBreak.current : initTime.current); \r\n        }\r\n    }\r\n\r\n    // Timer ending alarm\r\n    function beep() {\r\n        let audio = new Audio(props.type === 'SHORT' ? BEEP : BELL);   \r\n\r\n        audio.volume = alarmVol.current; // option\r\n\r\n        let playCnt = 1;\r\n        audio.addEventListener('ended', async function() {\r\n            playCnt++;\r\n            if(playCnt >= 1) return;\r\n            \r\n            await new Promise(r => setTimeout(r, 300)); // sleep\r\n            \r\n            this.currentTime = 0;\r\n            this.play();\r\n        }, false);\r\n        audio.play(); \r\n    }\r\n\r\n    function toggleBreak(){\r\n        setBreak(onBreak=>!onBreak);\r\n        reset();\r\n    }\r\n\r\n    // Send browser notification (tested on Chrome)\r\n    function sendNotification(breakStart = true){\r\n        console.log(\"Noti : \", onNoti);\r\n        if(!onNoti) return;\r\n        \r\n        const type = `${props.type === \"SHORT\" ? \"Short\" : \"Long\"}`;\r\n        const title = type + \" timer\" + `${breakStart ? \" over!\" : \" start!\"}`;\r\n        const body = `${breakStart ? \"Break time \" + initBreak.current / MINUTE  : \"Focus for another \" + initTime.current / MINUTE}` + \" minutes\"\r\n\r\n        const notification = new Notification(title, {\r\n            body: body,\r\n            icon : IMG\r\n        });\r\n\r\n        notification.addEventListener('click', (evt) => {\r\n            //parent.focus();\r\n            window.focus();\r\n            console.log(evt.target);\r\n            //evt.target.close();\r\n        });\r\n    }\r\n\r\n\r\n    // =============================================================================\r\n    // apply new settings from 'TimeSettingsModal'\r\n    function applyTimeSettings(timeObj){\r\n        initTime.current = timeObj.timerTime;\r\n        initBreak.current = timeObj.breakTime;\r\n        reset();\r\n        \r\n        // Update initTime and cache\r\n        const key = 'initTimeSettings-json';\r\n        let cachedTimeObj = JSON.parse(localStorage.getItem(key));\r\n        if(props.type === \"SHORT\"){\r\n            cachedTimeObj = Object.assign({}, cachedTimeObj, {\r\n                shortTT : timeObj.timerTime,\r\n                shortBT : timeObj.breakTime\r\n            });\r\n        }\r\n        else{\r\n            cachedTimeObj = Object.assign({}, cachedTimeObj, {\r\n                longTT : timeObj.timerTime,\r\n                longBT : timeObj.breakTime\r\n            });\r\n        }\r\n        window.localStorage.setItem(key, JSON.stringify(cachedTimeObj)); // cache time settings\r\n    }\r\n\r\n    // Apply updates from writableClock (initTime setting and localStorage cache)\r\n    // Can only update timerTime or breakTime at a time (depends on 'onBreak' flag)\r\n    function updateFromClock(time){\r\n        let timeObj = {\r\n            timerTime : initTime.current,\r\n            breakTime : initBreak.current\r\n        }\r\n        if(onBreak){\r\n            Object.assign(timeObj, {breakTime : time});\r\n        }\r\n        else{\r\n            Object.assign(timeObj, {timerTime : time});\r\n        }\r\n\r\n        applyTimeSettings(timeObj);\r\n    }\r\n\r\n\r\n    return (\r\n        <div className = \"timerNswitch\">\r\n            <div className = \"timerBox\">\r\n                <span id = \"breakNotify\">{onBreak ? \"(on Break)\" : \" \"}</span>\r\n                <br/>\r\n                <p>\r\n                    <WritableClock\r\n                        key={key}\r\n                        time={curTime}   \r\n                        pause={()=>reset(true)} // pause\r\n                        update={(time)=>updateFromClock(time)}\r\n                    ></WritableClock>\r\n                </p>\r\n                <br/>\r\n                <div className = \"buttonSet\">\r\n                    <button className = \"button\" id=\"start\" onClick = {()=>setDidStart(true)}> Start </button>\r\n                    <button className = \"button\" id=\"pause\" onClick = {()=>reset(true)}> Pause </button>\r\n                    <button className = \"button secondary\" id=\"reset\" onClick = {()=>reset()}> Reset </button>\r\n                    <button className = \"button secondary\" id=\"timeSettings\" data-modal-target = \"SHORT\" onClick = {()=>setModalOpen(true)}> Time </button>\r\n                </div>\r\n            </div>\r\n\r\n            <label className=\"switch\">\r\n                <input type=\"checkbox\" onChange={()=>toggleBreak()} checked={onBreak}></input>\r\n                <span className=\"slider round\"></span>\r\n            </label>\r\n\r\n            <TimeSettingsModal \r\n                type={props.type}\r\n                isOpen={modalOpen} \r\n                close={()=>setModalOpen(false)} \r\n                save={(timeObj)=>applyTimeSettings(timeObj)}>\r\n            </TimeSettingsModal>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Timer;","import { createSlice } from '@reduxjs/toolkit';\r\n\r\nconst initialState = {\r\n    onNoti: false\r\n}\r\n\r\nexport const notiSlice = createSlice({\r\n    name: 'noti',\r\n    initialState,\r\n    // The `reducers` field lets us define reducers and generate associated actions\r\n    reducers: {\r\n        turnOn: (state) => {\r\n            state.onNoti = true;\r\n        },\r\n        turnOff: (state) => {\r\n            state.onNoti = false;\r\n        }\r\n    }\r\n});\r\n\r\nexport const { turnOn, turnOff } = notiSlice.actions;\r\n\r\nexport default notiSlice.reducer;","import React, {useState, useEffect} from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { turnOn, turnOff } from '../slices/notiSlice';\r\nimport '../styles/SettingsModal.css';\r\nimport Modal from 'react-modal';\r\n\r\nModal.setAppElement('#root');\r\n\r\nexport default function GeneralSettingsModal(props) {\r\n    const [vol, setVol] = useState(props.curSettings.volume);\r\n    const [autoStart, setAutoStart] = useState(props.curSettings.autoStart);\r\n    \r\n    // Redux\r\n    const onNoti = useSelector(state => state.onNoti);\r\n    const dispatch = useDispatch();\r\n\r\n    // set keyboard keydown\r\n    useEffect(() => {\r\n        document.addEventListener('keydown', keydownEvents);\r\n        return ()=>document.removeEventListener('keydown', keydownEvents);\r\n    });\r\n    \r\n    const keydownEvents = (evt)=>{\r\n        if(props.isOpen && (evt.code === 'Space' || evt.code === 'Enter')){ // only when the modal is opened\r\n            evt.preventDefault();\r\n            saveSettings();\r\n        }\r\n    };\r\n\r\n    function saveSettings(evt=null){\r\n        if(evt) evt.preventDefault();\r\n\r\n        alert(\"Settings saved\");\r\n        const settingsObj = {\r\n            volume: Number.parseFloat(vol),\r\n            autoStart: autoStart,\r\n            //onNoti: onNoti\r\n        }\r\n        props.save(settingsObj);\r\n        props.close();\r\n    }\r\n\r\n    function checkPermission(){\r\n        // Check off - Turn off notification\r\n        if(onNoti){\r\n            dispatch(turnOff());\r\n        }\r\n        // Check on - Turn on the notification, ask for permission if not granted yet \r\n        else{\r\n            if(Notification.permission !== \"granted\"){\r\n                Notification.requestPermission().then(permission => {\r\n                    if(permission === \"granted\"){\r\n                        console.log(\"Permission granted\");\r\n                        dispatch(turnOn());\r\n                    }\r\n                    else console.log(\"Permission denied\");\r\n                })\r\n            }\r\n            else{\r\n                dispatch(turnOn());\r\n            }\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Modal \r\n            className=\"modal\" \r\n            id=\"general\"\r\n            closeTimeoutMS={200}\r\n            isOpen={props.isOpen} \r\n            onRequestClose={props.close}>\r\n            <div className=\"modal\" id=\"general\" >\r\n                <div className=\"modal-header\">\r\n                    <span className=\"title\">General Settings</span>\r\n                    <button className=\"close-button\" onClick={props.close}> &times; </button>\r\n                </div>\r\n\r\n                <div className=\"modal-body\">  \r\n                    <form onSubmit={saveSettings}>\r\n                        <div className=\"settings\">\r\n                            <div className=\"settings-container-checkbox\">\r\n                                <label>\r\n                                    <input type=\"checkbox\" \r\n                                        checked={autoStart} \r\n                                        onChange={()=>{setAutoStart(autoStart=>!autoStart);}}>\r\n                                    </input> Auto start timers and breaks?\r\n                                </label>\r\n                                <label>\r\n                                    <input type=\"checkbox\" \r\n                                        checked={onNoti} \r\n                                        onChange={()=>{checkPermission()}}>\r\n                                    </input> Send notification when the timer is over\r\n                                </label>\r\n                            </div>\r\n                            \r\n                            <br/>\r\n\r\n                            <div className=\"settings-container-slider\">\r\n                                Select alarm volume\r\n                                <input className=\"slide\" id=\"volume\" type=\"range\" min=\"0\" max=\"1\" step=\"0.01\" \r\n                                value={vol}\r\n                                onChange={(evt)=>{setVol(evt.target.value);}}></input>\r\n                            </div>\r\n                        </div>\r\n                        <input className=\"settings-save\" type=\"submit\" value=\"Submit\" />\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        </Modal>\r\n    )\r\n}","import React, {useState} from 'react';\r\n\r\nimport './styles/App.css';\r\nimport Timer from './components/Timer';\r\nimport GeneralSettingsModal from './components/GeneralSettingsModal.js';\r\n\r\nconst MINIUTE = 60;\r\n\r\nfunction App(props) {\r\n  const [toggleSecond, setToggleSecond] = useState(false);\r\n  const [modalOpen, setModalOpen] = useState(false);\r\n  const [key, setKey] = useState(0);\r\n\r\n  // Initial time settings\r\n  let initTimeObj = { \r\n    shortTT : 25 * MINIUTE,\r\n    shortBT: 5 * MINIUTE,\r\n    longTT : 50 * MINIUTE,\r\n    longBT: 10 * MINIUTE,\r\n  }; // TT : Timer Time, BT : Break Time\r\n\r\n  // General settings - for both timers : volume, autostart, ...\r\n  let genSettingsObj = {\r\n    volume: 1,\r\n    autoStart: false,\r\n    //onNoti: false // controlled by Redux\r\n  };\r\n\r\n  // [Cache] Retrieve saved settings from localStorage\r\n  let generalCache = localStorage.getItem('generalSettings-json')\r\n  if (generalCache) genSettingsObj = JSON.parse(generalCache);\r\n\r\n  let timeCache = localStorage.getItem('initTimeSettings-json')\r\n  if (timeCache) initTimeObj = JSON.parse(timeCache);\r\n  \r\n\r\n  // =============================================================================\r\n  // Called when general settings modal closes\r\n  function applySettings(settingsObj){\r\n    //console.log(\"--Applying general settings - expecting re-rendering--\")\r\n\r\n    genSettingsObj = settingsObj;\r\n    localStorage.setItem('generalSettings-json', JSON.stringify(settingsObj)); // cache general settings\r\n    setKey(key=>key+1); // re-render Timer components by changing the key\r\n  }\r\n\r\n\r\n  // =============================================================================\r\n  // Reset\r\n  function resetAllSettings(){\r\n    if(window.confirm(\"Reset settings?\")){\r\n      localStorage.clear(); \r\n      document.location.reload(); // reload webpage\r\n    }\r\n  }\r\n\r\n\r\n  return (\r\n    <>\r\n      <div className=\"header\">\r\n        <span className=\"title\">Pomodoro Timer Plus+</span>\r\n        <div className=\"main-buttonSet\">\r\n          <button onClick = {()=>setToggleSecond(!toggleSecond)}>Long-Timer</button>\r\n          <button onClick = {()=>setModalOpen(true)}>Settings</button>\r\n          <button onClick = {()=>resetAllSettings()}>Reset Settings</button>\r\n        </div>\r\n\r\n      </div>\r\n      <div className = \"wrapper\">\r\n        <Timer \r\n          key = {key}\r\n          type = \"SHORT\" \r\n          settings = {Object.assign({}, genSettingsObj, \r\n                                        {timerTime:initTimeObj.shortTT, breakTime:initTimeObj.shortBT})}\r\n        >\r\n        </Timer>\r\n        {toggleSecond ?\r\n          <Timer \r\n            key = {key + 2} // if set to key + 1, React confuses short timer with long timer whenever key is incremented\r\n            type = \"LONG\" \r\n            settings = {Object.assign({}, genSettingsObj, \r\n                                          {timerTime:initTimeObj.longTT, breakTime:initTimeObj.longBT})}\r\n          >\r\n          </Timer>\r\n          : null\r\n        }\r\n      </div>\r\n\r\n      <GeneralSettingsModal\r\n        key = {key + 3}\r\n        curSettings={genSettingsObj}\r\n        id=\"modalTest\"\r\n        isOpen={modalOpen} \r\n        close={()=>setModalOpen(false)} \r\n        save={(num)=>applySettings(num)}\r\n      >\r\n      </GeneralSettingsModal>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;","import { configureStore } from '@reduxjs/toolkit';\r\nimport notiReducer from '../slices/notiSlice';\r\n\r\nimport {\r\n  persistStore,\r\n  persistReducer,\r\n  FLUSH,\r\n  REHYDRATE,\r\n  PAUSE,\r\n  PERSIST,\r\n  PURGE,\r\n  REGISTER,\r\n} from 'redux-persist'\r\nimport storage from 'redux-persist/lib/storage'\r\n\r\nconst persistConfig = {\r\n  key: 'root',\r\n  storage: storage,\r\n  version: 1,\r\n}\r\n\r\nconst persistedReducer = persistReducer(persistConfig, notiReducer)\r\n\r\nexport const store = configureStore({\r\n  reducer: persistedReducer,\r\n  middleware: (getDefaultMiddleware) =>\r\n    getDefaultMiddleware({\r\n      serializableCheck: {\r\n        ignoredActions: [FLUSH, REHYDRATE, PAUSE, PERSIST, PURGE, REGISTER],\r\n      },\r\n    }),\r\n})\r\n\r\nexport const persistor = persistStore(store);","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\n\r\nimport { store, persistor } from './app/store';\r\nimport { Provider } from 'react-redux';\r\nimport { PersistGate } from 'redux-persist/integration/react'\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <PersistGate loading={null} persistor={persistor}>\r\n        <App />\r\n      </PersistGate>\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}